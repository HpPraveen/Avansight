@model IEnumerable<Avansight.Domain.Patient>

@{
    ViewData["Title"] = "Patient Details";
}

<h1>Simulate Patient</h1>

<hr />
<div class="row">
    <div class="col-md-6">
        <form asp-action="Index">
            <div class="form-group row">
                <label class="col-sm-4 col-form-label">Sample Size:</label>
                <div class="col-sm-4">
                    <input type="number" min="10" class="form-control" id="sampleSize" required>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-4 col-form-label">Gender (Weight):</label>
                <div class="col-sm-8">
                    <input class="col-sm-5" type="number" min="1" placeholder="Male" id="maleW">
                    <input class="col-sm-5" type="number" min="1" placeholder="Female" id="femaleW">
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Age:</label>
                <div class="col-sm-10">
                    <label class="col-sm-2 col-form-label">21-30</label>
                    <label class="col-sm-2 col-form-label">31-40</label>
                    <label class="col-sm-2 col-form-label">41-50</label>
                    <label class="col-sm-2 col-form-label">51-60</label>
                    <label class="col-sm-2 col-form-label">61-70</label>
                    <input class="col-sm-2" type="number" min="1" id="ageGrp1">
                    <input class="col-sm-2" type="number" min="1" id="ageGrp2">
                    <input class="col-sm-2" type="number" min="1" id="ageGrp3">
                    <input class="col-sm-2" type="number" min="1" id="ageGrp4">
                    <input class="col-sm-2" type="number" min="1" id="ageGrp5">

                </div>
            </div>
            <hr />
            <button type="submit" class="btn btn-primary" id="generatePatient">Generate Patient</button>
            <hr />
            <div id="partialView"></div>
            <hr />
        </form>
    </div>
</div>

<div>

</div>

@section Scripts {
    @*@{await Html.RenderPartialAsync("_ValidationScriptsPartial");}*@


<script type="text/javascript">

    $(function () {
            $("#partialView").load('@Url.Content("/Patient/PatientData")'); 
            GetPatientData();
        });

        function GetPatientData() {
            $("#generatePatient").click(function () {

                var sampleSizeValue = $("#sampleSize").val();
                var maleWeightValue = $("#maleW").val();
                var femaleWeightValue = $("#femaleW").val();
                var ageGrp1Value = $("#ageGrp1").val();
                var ageGrp2Value = $("#ageGrp2").val();
                var ageGrp3Value = $("#ageGrp3").val();
                var ageGrp4Value = $("#ageGrp4").val();
                var ageGrp5Value = $("#ageGrp5").val();

                var ageGrpValue = {};
                ageGrpValue.AgeGroup1 = ageGrp1Value;
                ageGrpValue.AgeGroup2 = ageGrp2Value;
                ageGrpValue.AgeGroup3 = ageGrp3Value;
                ageGrpValue.AgeGroup4 = ageGrp4Value;
                ageGrpValue.AgeGroup5 = ageGrp5Value;

                if (sampleSizeValue !== "") {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetPatientData")',
                        data: { sampleSize: sampleSizeValue, maleWeight: maleWeightValue, femaleWeight: femaleWeightValue, ageGroupData: ageGrpValue},
                        dataType: "json",
                        success: function (data) {
                            debugger;
                            var c = data;
                            @*$("#partialView").load('@Url.Content("/Patient/PatientData")');*@ 
                            alert("Data has been added successfully.");
                        },
                        error: function() {
                            alert("Error while inserting data");
                        }
                    });
                } else {
                    alert("Please add a Sample Size");
                }
            });
        }
</script>
}

